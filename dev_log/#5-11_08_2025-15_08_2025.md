# Dev log #5 | 11.08.2025 - 15.08.2025

## Found errors
One problem, we realized only now, is that the `liatris` controller only has 12 pin columns and the first 2 pins in the columns are for on board LEDs. 
Since the pcb was designed for the full 13 pin columns, we had to add a wire and connect it to a different pin. We have rewired the LED pin from *10 to 21*. It is important not to forget to change the pin number in `led_driver.h`.
![20250817_135319](https://github.com/user-attachments/assets/43e2c6ea-55a8-4681-8ebc-5826134ac2f8)
The other controller we have is a `helios` controller and that one is fine.

## Software
We have setup the controller using `tinyUsb` as a CDC serial device. This allows us to send serial data from the computer to the mcu and in the future the data will be sent by a screen reader.
In the current version, the software receives the serial data, which is a string, and looks it up in the dictionary. After that it lights up the necessary keys to write said word. In the future, we may move to a 2 controller setup, where one will have javelin loaded and send key presses to the other "master controller". This one will decide which mode, reading or writing, is active and depending on that either propagate the keypresses to the computer, or compare them against the word provided by the screen reader. This means, that the master controller will appear as a composite device, so it will have both a CDC interface and an HID keyboard interface.

### Existing problems
There are still a few things left to patch. Right now, it searches for the first occurence of the word in the dictionairy, doesn't understand special symbols like numbers or '-' and the keys do not do anything.

### Steps to reproduce
#### Test keyboard with javelin
You can just follow the instruction in the [javelin-steno-pico](https://github.com/jthlim/javelin-steno-pico) repository for custom firmware. The config file needed is provided [here](https://github.com/gradesta/readable-steno/blob/main/config/readable_steno.h).

#### LED reading software demo
First, you need to translate the dictionairy into a `.h` file. [Here](https://github.com/gradesta/readable-steno/blob/main/dev_log/%234-28_07_2025-8_8_2025.md) is how. If you used a different dictionairy, you need to change the filename in the include in `main.c`. After that you create a build folder and run cmake:
```
mkdir build
cd build
cmake .. OR cmake -DPICO_SDK_PATH=path/to/pico-sdk .. (the second one, if you do not have it set in env variables)
make
```
Now you should have a .uf2 file in the build folder. Set the mcu into `BOOTSEL` and drag the file onto the mcu. Open a serial monitor, e.g. screen on linux and give the word you wish to light up. Press enter and it should show up.

![ezgif-3a2dac6e69cffe](https://github.com/user-attachments/assets/bc72ea3b-cd63-4601-8d35-2472d413bc74)
The quality is low, but the word is `swore`.

